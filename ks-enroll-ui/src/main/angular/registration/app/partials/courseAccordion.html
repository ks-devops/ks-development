<!--
    HTML for displaying the card for a specific course. Utilized for
    registered courses, waitlisted courses, and the registration cart.
    Implemented via the course-accordion directive (see course-card.js)
-->
<accordion close-others="oneAtATime" ng-if="!course.dropped && !course.dropProcessing">
    <accordion-group is-open="course.isopen">
        <accordion-heading>
            <div class="kscr-Card-accordion-heading" ng-class="{'kscr-Card-course': type==='cart', 'kscr-Card-accordion-heading-fadeIn': course.addingNewCartItem}">
                <!-- Expand/Collapse Icon -->
                <span class="kscr-Card-icon"><i class="glyphicon" ng-class="{'glyphicon-chevron-down': course.isopen, 'glyphicon-chevron-right': !course.isopen}"></i></span>

                <!--credits-->
                <div id="{{config.prefix2}}course_info_{{course.courseCode}}_{{course.regGroupCode}}" class="kscr-Card-supportText" ng-hide="course.editing" ng-class="{ 'kscr-Card-credits-fadeIn': course.editCredits, 'kscr-Card-credits-fadeOut': course.editCreditsDone }">
                    <ng-pluralize count="course.credits" when="{'1': '{} cr', 'other': '{} cr'}"></ng-pluralize>
                </div>

                <!--Course Header Section-->
                <div class="kscr-Card-heading">
                    <div>
                        <span class="kscr-Card-title" id="{{config.prefix2}}course_code_{{course.courseCode}}_{{course.regGroupCode}}">
                            <strong>{{course.courseCode}} ({{course.regGroupCode}})</strong>
                            <i ng-show="type==='waitlist'" class="glyphicon glyphicon-time kscr-Waitlisted-clockIcon"></i>
                        </span>
                        <span id="{{config.prefix2}}grading_badge_{{course.courseCode}}_{{course.regGroupCode}}"
                              ng-show="showBadge(course)" ng-class="{ 'kscr-Card-badge-fadeIn': course.editGradingOption,
                              'kscr-Card-badge-fade': !course.editGradingOption,
                              'kscr-Card-badge-fadeOutLetter': course.editGradingOptionLetter
                              && course.editGradingOptionDone }">{{gradingOption(course)}}</span>
                    </div>

                    <!--Course Title and description-->
                    <div class="kscr-Card-text" id="title_{{course.courseCode}}_{{course.regGroupCode}}" ng-show="course.isopen">{{courseTitle(course)}}</div>

                    <!--AO info: type, time, location-->
                    <div ng-repeat="ao in course.activityOfferings" class="kscr-Card-detailsText--show" ng-show="!course.isopen" ng-if="type!=='cart'">
                        <span class="kscr-Card-courseTimes">
                            <div id="{{config.prefix2}}ao_type_{{course.courseCode}}_{{course.regGroupCode}}_{{$index}}" class="kscr-Card-ao-type">{{ao.activityOfferingTypeName | limitTo : 3}}</div>
                            <div ng-repeat="scheduleComponent in ao.scheduleComponents" id="{{config.prefix2}}schedule_{{course.courseCode}}_{{course.regGroupCode}}_{{$parent.$index}}_{{$index}}" class="kscr-Card-scheduleComponent">
                                <span ng-hide="scheduleComponent.isTBA" class="util-Grid--floatLeft">{{scheduleComponent.days}} {{scheduleComponent.displayTime}}</span>
                                <span ng-hide="scheduleComponent.isTBA" class="util-Grid--floatRight">{{scheduleComponent.buildingCode}} {{scheduleComponent.roomCode}}</span>
                                <span ng-show="scheduleComponent.isTBA" class="util-Grid--floatRight">TBA</span>
                            </div>
                        </span>
                    </div>

                    <div ng-repeat="item in course.schedule" class="kscr-Card-detailsText--show" ng-show="!course.isopen" ng-if="type==='cart'">
                        <span class="kscr-Card-courseTimes">
                            <div id="ao_type_{{course.courseCode}}_{{course.regGroupCode}}_{{$index}}" class="kscr-Card-ao-type">{{item.activityOfferingType | limitTo : 3}}</div>
                            <div ng-repeat="scheduleItem in item.activityOfferingLocationTime" id="schedule_{{course.courseCode}}_{{course.regGroupCode}}_{{$parent.$index}}_{{$index}}" class="kscr-Card-scheduleComponent">
                                <span ng-hide="scheduleItem.isTBA" class="util-Grid--floatLeft">{{scheduleItem.time.days}} {{scheduleItem.time.displayTime}}</span>
                                <span ng-hide="scheduleItem.isTBA" class="util-Grid--floatRight">{{scheduleItem.location.building}} {{scheduleItem.location.room}}</span>
                                <span ng-show="scheduleItem.isTBA" class="util-Grid--floatRight">TBA</span>
                            </div>
                        </span>
                    </div>
                </div>
            </div>
        </accordion-heading>

        <div class="kscr-Waitlisted-details" ng-if="type==='waitlist'">
            <i class="glyphicon glyphicon-time kscr-Waitlisted-clockIcon"></i> Waitlisted for this course
        </div>

        <!-- Course details: AO type, start-end dates, etc. -->
        <div ng-hide="course.editing">
            <!--course time, day, building-->
            <div ng-repeat="ao in course.activityOfferings" class="kscr-Card-detailsText--edit" ng-if="type !== 'cart'">
                <div>
                    <span id="{{config.prefix2}}ao_type_long_{{course.courseCode}}_{{course.regGroupCode}}_{{$index}}">{{ao.activityOfferingTypeName}}</span>
                    <span class="kscr-Card-ao-instructor">
                        <div ng-repeat="instructor in ao.instructors">{{instructor.firstName}} {{instructor.lastName}}</div>
                    </span>
                </div>
                <div ng-repeat="scheduleComponent in ao.scheduleComponents" id="{{config.prefix2}}schedule_long_{{course.courseCode}}_{{course.regGroupCode}}_{{$parent.$index}}_{{$index}}" class="kscr-Card-ao-schedule">
                    <span ng-hide="scheduleComponent.isTBA" class="util-Grid--floatLeft">{{scheduleComponent.days}} {{scheduleComponent.displayTime}}</span>
                    <span ng-hide="scheduleComponent.isTBA" class="util-Grid--floatRight">{{scheduleComponent.buildingCode}} {{scheduleComponent.roomCode}}</span>
                    <span ng-show="scheduleComponent.isTBA">TBA</span>
                </div>
                <div class="util-Grid--clearfix"></div>
            </div>

            <div ng-repeat="item in course.schedule" class="kscr-Card-detailsText--edit" ng-if="type === 'cart'">
                <div>
                    <span id="ao_type_long_{{course.courseCode}}_{{course.regGroupCode}}_{{$index}}">{{item.activityOfferingType}}</span>
                    <span class="kscr-Card-ao-instructor">
                        <div ng-repeat="instructor in item.instructors">{{instructor.firstName}} {{instructor.lastName}}</div>
                    </span>
                </div>
                <div ng-repeat="scheduleItem in item.activityOfferingLocationTime" id="schedule_long_{{course.courseCode}}_{{course.regGroupCode}}_{{$parent.$index}}_{{$index}}" class="kscr-Card-ao-schedule">
                    <span ng-hide="scheduleItem.isTBA" class="util-Grid--floatLeft">{{scheduleItem.time.days}} {{scheduleItem.time.displayTime}}</span>
                    <span ng-hide="scheduleItem.isTBA" class="util-Grid--floatRight">{{scheduleItem.location.building}} {{scheduleItem.location.room}}</span>
                    <span ng-show="scheduleItem.isTBA"> TBA</span>
                </div>
                <div class="util-Grid--clearfix"></div>
            </div>

            <!--Course Edit/Remove Buttons-->
            <div class="kscr-Card-buttons">
                <span>
                    <!--<button class="btn">Details</button>-->
                    <button class="kscr-Button" id="{{config.prefix2}}edit_{{course.courseCode}}_{{course.regGroupCode}}" ng-click="editItem(course)" ng-show="course.creditOptions.length > 1 || course.gradingOptionCount > 1">Edit</button>
                    <div class="global-Base-divider"></div>
                    <button class="kscr-Button" id="{{config.prefix2}}remove_{{course.courseCode}}_{{course.regGroupCode}}" ng-click="dropCourse(cardIndex, course)">{{config.remove}}</button>
                </span>
            </div>
        </div>

        <!-- Item Change Section: Credits, Grading, and Save -->
        <course-options course="course" prefix="{{config.prefix3}}" on-submit="updateItem(course)" ng-show="course.editing"></course-options>
    </accordion-group>
</accordion>